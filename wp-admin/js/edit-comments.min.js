var setCommentsList,theList,theExtraList,commentReply;!function(t){var e,n,a;setCommentsList=function(){var o,s,i,r,l,c,m,p,d,u=0;o=t('input[name="_total"]',"#comments-form"),s=t('input[name="_per_page"]',"#comments-form"),i=t('input[name="_page"]',"#comments-form"),r=function(e,n){var o,s,i,r=t("#"+n.element);o=t("#replyrow"),s=t("#comment_ID",o).val(),i=t("#replybtn",o),r.is(".unapproved")?(n.data.id==s&&i.text(adminCommentsL10n.replyApprove),r.find("div.comment_status").html("0")):(n.data.id==s&&i.text(adminCommentsL10n.reply),r.find("div.comment_status").html("1")),d=t("#"+n.element).is("."+n.dimClass)?1:-1,a(d)},l=function(e,n){var a,r,l,c,m,p,d,u=!1,h=t(e.target).attr("data-wp-lists");return e.data._total=o.val()||0,e.data._per_page=s.val()||0,e.data._page=i.val()||0,e.data._url=document.location.href,e.data.comment_status=t('input[name="comment_status"]',"#comments-form").val(),-1!=h.indexOf(":trash=1")?u="trash":-1!=h.indexOf(":spam=1")&&(u="spam"),u&&(r=h.replace(/.*?comment-([0-9]+).*/,"$1"),l=t("#comment-"+r),a=t("#"+u+"-undo-holder").html(),l.find(".check-column :checkbox").prop("checked",!1),l.siblings("#replyrow").length&&commentReply.cid==r&&commentReply.close(),l.is("tr")?(c=l.children(":visible").length,d=t(".author strong",l).text(),m=t('<tr id="undo-'+r+'" class="undo un'+u+'" style="display:none;"><td colspan="'+c+'">'+a+"</td></tr>")):(d=t(".comment-author",l).text(),m=t('<div id="undo-'+r+'" style="display:none;" class="undo un'+u+'">'+a+"</div>")),l.before(m),t("strong","#undo-"+r).text(d),p=t(".undo a","#undo-"+r),p.attr("href","comment.php?action=un"+u+"comment&c="+r+"&_wpnonce="+e.data._ajax_nonce),p.attr("data-wp-lists","delete:the-comment-list:comment-"+r+"::un"+u+"=1"),p.attr("class","vim-z vim-destructive"),t(".avatar",l).first().clone().prependTo("#undo-"+r+" ."+u+"-undo-inside"),p.click(function(){return n.wpList.del(this),t("#undo-"+r).css({backgroundColor:"#ceb"}).fadeOut(350,function(){t(this).remove(),t("#comment-"+r).css("backgroundColor","").fadeIn(300,function(){t(this).show()})}),!1})),e},c=function(t,e,n){u>e||(n&&(u=e),o.val(t.toString()))},e=function(t){var e=parseInt(t.html().replace(/[^0-9]+/g,""),10);return isNaN(e)?0:e},n=function(t,e){var n="";if(!isNaN(e)){if(e=1>e?"0":e.toString(),e.length>3){for(;e.length>3;)n=thousandsSeparator+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);e+=n}t.html(e)}},a=function(a){t("span.pending-count").each(function(){var o=t(this),s=e(o)+a;1>s&&(s=0),o.closest(".awaiting-mod")[0===s?"addClass":"removeClass"]("count-0"),n(o,s)})},m=function(s,i){function r(e){return t(i.target).parent().is("span."+e)?1:t("#"+i.element).is("."+e)?-1:0}var l,m,d,h,f,v=t(i.target).parent().is("span.untrash"),g=t(i.target).parent().is("span.unspam"),y=t("#"+i.element).is(".unapproved");h=v?-1:r("trash"),d=g?-1:r("spam"),t(i.target).parent().is("span.unapprove")||(v||g)&&y?f=1:y&&(f=-1),f&&a(f),t("span.spam-count").each(function(){var a=t(this),o=e(a)+d;n(a,o)}),t("span.trash-count").each(function(){var a=t(this),o=e(a)+h;n(a,o)}),t("#dashboard_right_now").length||(m=o.val()?parseInt(o.val(),10):0,t(i.target).parent().is("span.undo")?m++:m--,0>m&&(m=0),"object"==typeof s&&u<i.parsed.responses[0].supplemental.time?(l=i.parsed.responses[0].supplemental.total_items_i18n||"",l&&(t(".displaying-num").text(l),t(".total-pages").text(i.parsed.responses[0].supplemental.total_pages_i18n),t(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",i.parsed.responses[0].supplemental.total_pages==t(".current-page").val())),c(m,i.parsed.responses[0].supplemental.time,!0)):c(m,s,!1)),!theExtraList||0===theExtraList.size()||0===theExtraList.children().size()||v||g||(theList.get(0).wpList.add(theExtraList.children(":eq(0)").remove().clone()),p())},p=function(e){var n=t.query.get(),a=t(".total-pages").text(),o=t('input[name="_per_page"]',"#comments-form").val();n.paged||(n.paged=1),n.paged>a||(e?(theExtraList.empty(),n.number=Math.min(8,o)):(n.number=1,n.offset=Math.min(8,o)-1),n.no_placeholder=!0,n.paged++,!0===n.comment_type&&(n.comment_type=""),n=t.extend(n,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:t("#_ajax_fetch_list_nonce").val()}),t.ajax({url:ajaxurl,global:!1,dataType:"json",data:n,success:function(t){theExtraList.get(0).wpList.add(t.rows)}}))},theExtraList=t("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"}),theList=t("#the-comment-list").wpList({alt:"",delBefore:l,dimAfter:r,delAfter:m,addColor:"none"}).bind("wpListDelEnd",function(e,n){var a=t(n.target).attr("data-wp-lists"),o=n.element.replace(/[^0-9]+/g,"");(-1!=a.indexOf(":trash=1")||-1!=a.indexOf(":spam=1"))&&t("#undo-"+o).fadeIn(300,function(){t(this).show()})})},commentReply={cid:"",act:"",init:function(){var e=t("#replyrow");t("a.cancel",e).click(function(){return commentReply.revert()}),t("a.save",e).click(function(){return commentReply.send()}),t("input#author, input#author-email, input#author-url",e).keypress(function(t){return 13==t.which?(commentReply.send(),t.preventDefault(),!1):void 0}),t("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())}),t("#doaction, #doaction2, #post-query-submit").click(function(){t("#the-comment-list #replyrow").length>0&&commentReply.close()}),this.comments_listing=t('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(e){e.each(function(){t(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(t(this).parent())})})},toggle:function(e){"none"!=t(e).css("display")&&t(e).find("a.vim-q").click()},revert:function(){return t("#the-comment-list #replyrow").length<1?!1:(t("#replyrow").fadeOut("fast",function(){commentReply.close()}),!1)},close:function(){var e,n=t("#replyrow");n.parent().is("#com-reply")||(this.cid&&"edit-comment"==this.act&&(e=t("#comment-"+this.cid),e.fadeIn(300,function(){e.show()}).css("backgroundColor","")),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),t("#add-new-comment").css("display",""),n.hide(),t("#com-reply").append(n),t("#replycontent").css("height","").val(""),t("#edithead input").val(""),t(".error",n).empty().hide(),t(".spinner",n).removeClass("is-active"),this.cid="")},open:function(e,n,a){var o,s,i,r,l,c=this,m=t("#comment-"+e),p=m.height();return c.close(),c.cid=e,o=t("#replyrow"),s=t("#inline-"+e),a=a||"replyto",i="edit"==a?"edit":"replyto",i=c.act=i+"-comment",t("#action",o).val(i),t("#comment_post_ID",o).val(n),t("#comment_ID",o).val(e),"edit"==a?(t("#author",o).val(t("div.author",s).text()),t("#author-email",o).val(t("div.author-email",s).text()),t("#author-url",o).val(t("div.author-url",s).text()),t("#status",o).val(t("div.comment_status",s).text()),t("#replycontent",o).val(t("textarea.comment",s).val()),t("#edithead, #savebtn",o).show(),t("#replyhead, #replybtn, #addhead, #addbtn",o).hide(),p>120&&(l=p>500?500:p,t("#replycontent",o).css("height",l+"px")),m.after(o).fadeOut("fast",function(){t("#replyrow").fadeIn(300,function(){t(this).show()})})):"add"==a?(t("#addhead, #addbtn",o).show(),t("#replyhead, #replybtn, #edithead, #savebtn",o).hide(),t("#the-comment-list").prepend(o),t("#replyrow").fadeIn(300)):(r=t("#replybtn",o),t("#edithead, #savebtn, #addhead, #addbtn",o).hide(),t("#replyhead, #replybtn",o).show(),m.after(o),r.text(m.hasClass("unapproved")?adminCommentsL10n.replyApprove:adminCommentsL10n.reply),t("#replyrow").fadeIn(300,function(){t(this).show()})),setTimeout(function(){var e,n,a,o,s;e=t("#replyrow").offset().top,n=e+t("#replyrow").height(),a=window.pageYOffset||document.documentElement.scrollTop,o=document.documentElement.clientHeight||window.innerHeight||0,s=a+o,n>s-20?window.scroll(0,n-o+35):a>e-20&&window.scroll(0,e-35),t("#replycontent").focus().keyup(function(t){27==t.which&&commentReply.revert()})},600),!1},send:function(){var e={};return t("#replysubmit .error").hide(),t("#replysubmit .spinner").addClass("is-active"),t("#replyrow input").not(":button").each(function(){var n=t(this);e[n.attr("name")]=n.val()}),e.content=t("#replycontent").val(),e.id=e.comment_post_ID,e.comments_listing=this.comments_listing,e.p=t('[name="p"]').val(),t("#comment-"+t("#comment_ID").val()).hasClass("unapproved")&&(e.approve_parent=1),t.ajax({type:"POST",url:ajaxurl,data:e,success:function(t){commentReply.show(t)},error:function(t){commentReply.error(t)}}),!1},show:function(e){var n,o,s,i,r,l=this;return"string"==typeof e?(l.error({responseText:e}),!1):(n=wpAjax.parseAjaxResponse(e),n.errors?(l.error({responseText:wpAjax.broken}),!1):(l.revert(),n=n.responses[0],s="#comment-"+n.id,"edit-comment"==l.act&&t(s).remove(),n.supplemental.parent_approved&&(r=t("#comment-"+n.supplemental.parent_approved),a(-1),"moderated"==this.comments_listing)?void r.animate({backgroundColor:"#CCEEBB"},400,function(){r.fadeOut()}):(o=t.trim(n.data),t(o).hide(),t("#replyrow").after(o),s=t(s),l.addEvents(s),i=s.hasClass("unapproved")?"#FFFFE0":s.closest(".widefat, .postbox").css("backgroundColor"),void s.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:i},300,function(){r&&r.length&&r.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:i},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")}))))},error:function(e){var n=e.statusText;t("#replysubmit .spinner").removeClass("is-active"),e.responseText&&(n=e.responseText.replace(/<.[^<>]*?>/g,"")),n&&t("#replysubmit .error").html(n).show()},addcomment:function(e){var n=this;t("#add-new-comment").fadeOut(200,function(){n.open(0,e,"add"),t("table.comments-box").css("display",""),t("#no-comments").remove()})}},t(document).ready(function(){var e,n,a,o;setCommentsList(),commentReply.init(),t(document).delegate("span.delete a.delete","click",function(){return!1}),"undefined"!=typeof t.table_hotkeys&&(e=function(e){return function(){var n,a;n="next"==e?"first":"last",a=t(".tablenav-pages ."+e+"-page:not(.disabled)"),a.length&&(window.location=a[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+n+"=1")}},n=function(e,n){window.location=t("span.edit a",n).attr("href")},a=function(){t("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},o=function(e){return function(){var n=t('select[name="action"]');t('option[value="'+e+'"]',n).prop("selected",!0),t("#doaction").click()}},t.table_hotkeys(t("table.widefat"),["a","u","s","d","r","q","z",["e",n],["shift+x",a],["shift+a",o("approve")],["shift+s",o("spam")],["shift+d",o("delete")],["shift+t",o("trash")],["shift+z",o("untrash")],["shift+u",o("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:e("prev"),next_page_link_cb:e("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0})),t("#the-comment-list").on("click",".comment-inline",function(e){e.preventDefault();var n=t(this),a="replyto";"undefined"!=typeof n.data("action")&&(a=n.data("action")),commentReply.open(n.data("commentId"),n.data("postId"),a)})})}(jQuery);